{
    "Metadata": {
        "searchKey": "Cisco Umbrella",
        "solutionName": "CiscoUmbrella",
        "displayName": "Cisco Umbrella",
        "contentSource": "Solution",
        "sourceName": "CiscoUmbrella",
        "provider": "Cisco",
        "author": "Microsoft",
        "bladeSupportName": "Microsoft",
        "supportName": "Microsoft Corporation",
        "category": "Security - Automation (SOAR), Security - Cloud Security",
        "version": "3.0.2",
        "bladeDescription": "Note: Please refer to the following before installing the solution:\u2022 Review the solution Release NotesThe Cisco Umbrella solution for Microsoft Sentinel enables you to ingest Cisco Umbrella events stored in Amazon S3 into Microsoft Sentinel using the Amazon S3 REST API.Underlying Microsoft Technologies used:This solution takes a dependency on the following technologies, and some of these dependencies either may be in Preview state or might result in additional ingestion or operational costs:a. Azure Monitor HTTP Data Collector APIb. Azure FunctionsData Connectors: 1, Parsers: 1, Workbooks: 1, Analytic Rules: 10, Hunting Queries: 10, Custom Azure Logic Apps Connectors: 4, Playbooks: 4Learn more about Microsoft Sentinel | Learn more about Solutions",
        "contentPageDescription": "Note:Please refer to the following before installing the solution:\u2022 Review the solution Release Notes \u2022 There may be known issues pertaining to this Solution, please refer to them before installing.The Cisco Umbrella solution for Microsoft Sentinel enables you to ingest Cisco Umbrella events stored in Amazon S3 into Microsoft Sentinel using the Amazon S3 REST API.Underlying Microsoft Technologies used:This solution takes a dependency on the following technologies, and some of these dependencies either may be in Preview state or might result in additional ingestion or operational costs:a. Azure Monitor HTTP Data Collector APIb. Azure FunctionsData Connectors:1, Parsers:1, Workbooks:1, Analytic Rules:10, Hunting Queries:10, Custom Azure Logic Apps Connectors:4, Playbooks:4Learn more about Microsoft Sentinel | Learn more about Solutions",
        "contentType": "10Analytics rule1Data connector10Hunting query1Parser4Playbook1Workbook",
        "contentCount": 27,
        "solutionIcon": "https://store-images.s-microsoft.com/image/apps.42346.c831fa37-c174-4c50-a094-e820557d868e.13af787a-9520-474b-bbf7-d020fdd33f9b.3d716b59-cd03-40a8-a4f3-132ad1c3fc25",
        "versionIcon": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTAgMi42NTYyNUgxMS45ODc1VjkuNjA1NzRDMTEuOTg3NSA5LjcxNjI4IDExLjk0NTMgOS44MjIyOSAxMS44NzAxIDkuOTAwNDRDMTEuNzk1IDkuOTc4NiAxMS42OTMgMTAuMDIyNSAxMS41ODY4IDEwLjAyMjVIMC40MDA3NUMwLjI5NDQ2NCAxMC4wMjI1IDAuMTkyNTMyIDkuOTc4NiAwLjExNzM3NyA5LjkwMDQ0QzAuMDQyMjIxOCA5LjgyMjI5IDAgOS43MTYyOCAwIDkuNjA1NzRWMi42NTYyNVoiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcikiLz4KPHBhdGggZD0iTTAuNDAyNSAzLjk3NDAzZS0wNkgxMS41ODI0QzExLjY4ODcgMy45NzQwM2UtMDYgMTEuNzkwNiAwLjA0MzkxMzUgMTEuODY1NyAwLjEyMjA3M0MxMS45NDA5IDAuMjAwMjMyIDExLjk4MzEgMC4zMDYyMzkgMTEuOTgzMSAwLjQxNjc3NFYyLjY1NjIzSDBWMC40MTY3NzRDLTUuMDMxNjdlLTA3IDAuMzYxODg5IDAuMDEwNDIyOSAwLjMwNzU0NSAwLjAzMDY3MTggMC4yNTY4NjFDMC4wNTA5MjA3IDAuMjA2MTc3IDAuMDgwNTk2NCAwLjE2MDE1MiAwLjExNzk5NSAwLjEyMTQyOEMwLjE1NTM5NCAwLjA4MjcwMzEgMC4xOTk3NzkgMC4wNTIwNDIyIDAuMjQ4NjAyIDAuMDMxMjA0OUMwLjI5NzQyNiAwLjAxMDM2NzYgMC4zNDk3MjYgLTAuMDAwMjM1Njk2IDAuNDAyNSAzLjk3NDAzZS0wNloiIGZpbGw9IiMwMDc4RDQiLz4KPHBhdGggZD0iTTIuMDEyNyA2LjYzMzc5SDE0LjAwMDJWMTMuNTgzM0MxNC4wMDAyIDEzLjY5MzggMTMuOTU4IDEzLjc5OTggMTMuODgyOCAxMy44NzhDMTMuODA3NyAxMy45NTYxIDEzLjcwNTcgMTQuMDAwMSAxMy41OTk0IDE0LjAwMDFIMi40MTUyQzIuMzA4OTEgMTQuMDAwMSAyLjIwNjk4IDEzLjk1NjEgMi4xMzE4MiAxMy44NzhDMi4wNTY2NyAxMy43OTk4IDIuMDE0NDUgMTMuNjkzOCAyLjAxNDQ1IDEzLjU4MzNWNi42MzM3OUgyLjAxMjdaIiBmaWxsPSJ1cmwoI3BhaW50MV9saW5lYXIpIi8+CjxwYXRoIGQ9Ik0yLjQxNzgyIDMuOTczNjZIMTMuNTk3N0MxMy42NTA0IDMuOTczNDIgMTMuNzAyNiAzLjk4Mzk5IDEzLjc1MTQgNC4wMDQ3N0MxMy44MDAyIDQuMDI1NTUgMTMuODQ0NSA0LjA1NjEzIDEzLjg4MTkgNC4wOTQ3NkMxMy45MTkzIDQuMTMzMzkgMTMuOTQ5IDQuMTc5MzEgMTMuOTY5MyA0LjIyOTg4QzEzLjk4OTYgNC4yODA0NiAxNC4wMDAxIDQuMzM0NzEgMTQuMDAwMiA0LjM4OTUyVjYuNjMzNTJIMi4wMTI3VjQuMzg5NTJDMi4wMTI4MSA0LjMzNDQ4IDIuMDIzNCA0LjI4MDAxIDIuMDQzODcgNC4yMjkyNUMyLjA2NDMzIDQuMTc4NDkgMi4wOTQyNiA0LjEzMjQ1IDIuMTMxOTMgNC4wOTM3OUMyLjE2OTU5IDQuMDU1MTIgMi4yMTQyNSA0LjAyNDYgMi4yNjMzMiA0LjAwMzk4QzIuMzEyMzkgMy45ODMzNiAyLjM2NDkgMy45NzMwNiAyLjQxNzgyIDMuOTczNjZaIiBmaWxsPSIjMTk4QUIzIi8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXIiIHgxPSI1Ljk5Mjg4IiB5MT0iMTAuMDIxNiIgeDI9IjUuOTkyODgiIHkyPSIyLjY1NjI1IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiMwMDc4RDQiLz4KPHN0b3Agb2Zmc2V0PSIwLjUwMiIgc3RvcC1jb2xvcj0iIzQwOTNFNiIvPgo8c3RvcCBvZmZzZXQ9IjAuNzc1IiBzdG9wLWNvbG9yPSIjNUVBMEVGIi8+CjwvbGluZWFyR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQxX2xpbmVhciIgeDE9IjguMDA3MzIiIHkxPSIxMy45OTU1IiB4Mj0iOC4wMDczMiIgeTI9IjYuNjI5MjQiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzMyQkVERCIvPgo8c3RvcCBvZmZzZXQ9IjAuMTc1IiBzdG9wLWNvbG9yPSIjMzJDQUVBIi8+CjxzdG9wIG9mZnNldD0iMC40MSIgc3RvcC1jb2xvcj0iIzMyRDJGMiIvPgo8c3RvcCBvZmZzZXQ9IjAuNzc1IiBzdG9wLWNvbG9yPSIjMzJENEY1Ii8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+Cg=="
    },
    "DataConnectors": {
        "dataConnector": [
            {
                "searchKey": "CiscoUmbrellaDataConnector",
                "displayName": "Cisco Umbrella (using Azure Functions)",
                "description": "The Cisco Umbrella data connector provides the capability to ingest Cisco Umbrella events stored in Amazon S3 into Microsoft Sentinel using the Amazon S3 REST API. Refer to Cisco Umbrella log management documentation for more information.",
                "kind": "DataConnector",
                "dataTypes": "Cisco_Umbrella_dns_CL --Cisco_Umbrella_proxy_CL --Cisco_Umbrella_ip_CL --Cisco_Umbrella_cloudfirewall_CL --",
                "provider": "Cisco",
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            }
        ]
    },
    "AnalyticsRules": {
        "analyticsRule": [
            {
                "searchKey": "ee1818ec-5f65-4991-b711-bcf2ab7e36c3",
                "displayName": "Cisco Umbrella - URI contains IP address",
                "description": "Malware can use IP address to communicate with C2.",
                "kind": "AnalyticsRule",
                "ruleType": "Scheduled",
                "severity": "Medium",
                "query": "Cisco_Umbrella| where EventType == 'proxylogs'| where DvcAction =~ 'Allowed'| where UrlOriginal matches regex @'\\Ahttp:\\/\\/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}.*'| project TimeGenerated, SrcIpAddr, DstIpAddr, UrlOriginal, Identities",
                "ruleFrequency": "10 minutes",
                "rulePeriod": "10 minutes",
                "suppressionDuration": "1 hour",
                "thresholdTrigger": "more than 0",
                "tactics": [
                    "Command And Control",
                    "Exfiltration"
                ],
                "tacticsMultiple": "Command And Control1\ue946Exfiltration",
                "techniques": [
                    "T1071",
                    "T1567"
                ],
                "techniquesMultiple": "T10711\ue946T1567",
                "subTechniques": [],
                "subTechniquesMultiple": [],
                "entityMapping": [
                    {
                        "entityType": "URL",
                        "fieldMappings": [
                            {
                                "columnName": "UrlOriginal",
                                "identifier": "Url"
                            }
                        ]
                    },
                    {
                        "entityType": "IP",
                        "fieldMappings": [
                            {
                                "columnName": "SrcIpAddr",
                                "identifier": "Address"
                            }
                        ]
                    }
                ],
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "dataConnectorName": "Cisco Umbrella (using Azure Functions)",
                "dataTypes": "Cisco_Umbrella_proxy_CL --",
                "version": "1.1.1",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "8d537f3c-094f-430c-a588-8a87da36ee3a",
                "displayName": "Cisco Umbrella - Hack Tool User-Agent Detected",
                "description": "Detects suspicious user agent strings used by known hack tools",
                "kind": "AnalyticsRule",
                "ruleType": "Scheduled",
                "severity": "Medium",
                "query": "let user_agents=dynamic([                          '(hydra)',                          ' arachni/',                          ' BFAC ',                          ' brutus ',                          ' cgichk ',                          'core-project/1.0',                          ' crimscanner/',                          'datacha0s',                          'dirbuster',                          'domino hunter',                          'dotdotpwn',                          'FHScan Core',                          'floodgate',                          'get-minimal',                          'gootkit auto-rooter scanner',                          'grendel-scan',                          ' inspath ',                          'internet ninja',                          'jaascois',                          ' zmeu ',                          'masscan',                          ' metis ',                          'morfeus fucking scanner',                          'n-stealth',                          'nsauditor',                          'pmafind',                          'security scan',                          'springenwerk',                          'teh forest lobster',                          'toata dragostea',                          ' vega/',                          'voideye',                          'webshag',                          'webvulnscan',                          ' whcc/',                          ' Havij',                          'absinthe',                          'bsqlbf',                          'mysqloit',                          'pangolin',                          'sql power injector',                          'sqlmap',                          'sqlninja',                          'uil2pn',                          'ruler',                          'Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)'                          ]);Cisco_Umbrella| where EventType == \"proxylogs\"| where HttpUserAgentOriginal has_any (user_agents)| extend Message = \"Hack Tool User Agent\"| project TimeGenerated, Message, SrcIpAddr, DstIpAddr, UrlOriginal, HttpUserAgentOriginal",
                "ruleFrequency": "15 minutes",
                "rulePeriod": "15 minutes",
                "suppressionDuration": "1 hour",
                "thresholdTrigger": "more than 0",
                "tactics": [
                    "Execution",
                    "Discovery",
                    "Lateral Movement",
                    "Collection",
                    "Command And Control",
                    "Exfiltration"
                ],
                "tacticsMultiple": "Execution5\ue946DiscoveryLateral MovementCollectionCommand And ControlExfiltration",
                "techniques": [
                    "T1059",
                    "T1046",
                    "T1021",
                    "T1557",
                    "T1102",
                    "T1020"
                ],
                "techniquesMultiple": "T10595\ue946T1046T1021T1557T1102T1020",
                "subTechniques": [],
                "subTechniquesMultiple": [],
                "entityMapping": [
                    {
                        "entityType": "URL",
                        "fieldMappings": [
                            {
                                "columnName": "UrlOriginal",
                                "identifier": "Url"
                            }
                        ]
                    },
                    {
                        "entityType": "IP",
                        "fieldMappings": [
                            {
                                "columnName": "SrcIpAddr",
                                "identifier": "Address"
                            }
                        ]
                    }
                ],
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "dataConnectorName": "Cisco Umbrella (using Azure Functions)",
                "dataTypes": "Cisco_Umbrella_proxy_CL --",
                "version": "1.1.2",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "75297f62-10a8-4fc1-9b2a-12f25c6f05a7",
                "displayName": "Cisco Umbrella - Connection to Unpopular Website Detected",
                "description": "Detects first connection to an unpopular website (possible malicious payload delivery).",
                "kind": "AnalyticsRule",
                "ruleType": "Scheduled",
                "severity": "Medium",
                "query": "let top_million_list = Cisco_Umbrella| where EventType == \"proxylogs\"| extend Hostname = parse_url(UrlOriginal)[\"Host\"]| summarize count() by tostring(Hostname)| top 1000000 by count_| summarize make_list(Hostname);Cisco_Umbrella| where EventType == \"proxylogs\"| extend Hostname = parse_url(UrlOriginal)[\"Host\"]| where Hostname !in (top_million_list)| extend Message = \"Connect to unpopular website (possible malicious payload delivery)\"| project TimeGenerated, Message, SrcIpAddr, DstIpAddr, UrlOriginal ",
                "ruleFrequency": "1 day",
                "rulePeriod": "14 days",
                "suppressionDuration": "1 hour",
                "thresholdTrigger": "more than 0",
                "tactics": [
                    "Command And Control",
                    "Exfiltration"
                ],
                "tacticsMultiple": "Command And Control1\ue946Exfiltration",
                "techniques": [
                    "T1071",
                    "T1041"
                ],
                "techniquesMultiple": "T10711\ue946T1041",
                "subTechniques": [
                    "T1071.001"
                ],
                "subTechniquesMultiple": "T1071.001",
                "entityMapping": [
                    {
                        "entityType": "URL",
                        "fieldMappings": [
                            {
                                "columnName": "UrlOriginal",
                                "identifier": "Url"
                            }
                        ]
                    },
                    {
                        "entityType": "IP",
                        "fieldMappings": [
                            {
                                "columnName": "SrcIpAddr",
                                "identifier": "Address"
                            }
                        ]
                    }
                ],
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "dataConnectorName": "Cisco Umbrella (using Azure Functions)",
                "dataTypes": "Cisco_Umbrella_proxy_CL --",
                "version": "1.1.2",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "b12b3dab-d973-45af-b07e-e29bb34d8db9",
                "displayName": "Cisco Umbrella - Windows PowerShell User-Agent Detected",
                "description": "Rule helps to detect Powershell user-agent activity by an unusual process other than a web browser.",
                "kind": "AnalyticsRule",
                "ruleType": "Scheduled",
                "severity": "Medium",
                "query": "Cisco_Umbrella| where EventType == \"proxylogs\"| where HttpUserAgentOriginal contains \"WindowsPowerShell\"| extend Message = \"Windows PowerShell User Agent\"| project TimeGenerated, Message, SrcIpAddr, DstIpAddr, UrlOriginal, HttpUserAgentOriginal",
                "ruleFrequency": "15 minutes",
                "rulePeriod": "15 minutes",
                "suppressionDuration": "1 hour",
                "thresholdTrigger": "more than 0",
                "tactics": [
                    "Command And Control",
                    "Defense Evasion",
                    "Execution"
                ],
                "tacticsMultiple": "Command And Control2\ue946Defense EvasionExecution",
                "techniques": [
                    "T1132",
                    "T1027",
                    "T1059"
                ],
                "techniquesMultiple": "T11322\ue946T1027T1059",
                "subTechniques": [
                    "T1059.001"
                ],
                "subTechniquesMultiple": "T1059.001",
                "entityMapping": [
                    {
                        "entityType": "URL",
                        "fieldMappings": [
                            {
                                "columnName": "UrlOriginal",
                                "identifier": "Url"
                            }
                        ]
                    },
                    {
                        "entityType": "IP",
                        "fieldMappings": [
                            {
                                "columnName": "SrcIpAddr",
                                "identifier": "Address"
                            }
                        ]
                    }
                ],
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "dataConnectorName": "Cisco Umbrella (using Azure Functions)",
                "dataTypes": "Cisco_Umbrella_proxy_CL --",
                "version": "1.1.2",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "b619d1f1-7f39-4c7e-bf9e-afbb46457997",
                "displayName": "Cisco Umbrella - Crypto Miner User-Agent Detected",
                "description": "Detects suspicious user agent strings used by crypto miners in proxy logs.",
                "kind": "AnalyticsRule",
                "ruleType": "Scheduled",
                "severity": "Medium",
                "query": "Cisco_Umbrella| where EventType == \"proxylogs\"| where HttpUserAgentOriginal contains \"XMRig\" or HttpUserAgentOriginal contains \"ccminer\"| extend Message = \"Crypto Miner User Agent\"| project TimeGenerated, Message, SrcIpAddr, DstIpAddr, UrlOriginal, HttpUserAgentOriginal",
                "ruleFrequency": "15 minutes",
                "rulePeriod": "15 minutes",
                "suppressionDuration": "1 hour",
                "thresholdTrigger": "more than 0",
                "tactics": [
                    "Impact",
                    "Command And Control",
                    "Exfiltration"
                ],
                "tacticsMultiple": "Impact2\ue946Command And ControlExfiltration",
                "techniques": [
                    "T1496",
                    "T1071",
                    "T1041"
                ],
                "techniquesMultiple": "T14962\ue946T1071T1041",
                "subTechniques": [
                    "T1071.001"
                ],
                "subTechniquesMultiple": "T1071.001",
                "entityMapping": [
                    {
                        "entityType": "URL",
                        "fieldMappings": [
                            {
                                "columnName": "UrlOriginal",
                                "identifier": "Url"
                            }
                        ]
                    },
                    {
                        "entityType": "IP",
                        "fieldMappings": [
                            {
                                "columnName": "SrcIpAddr",
                                "identifier": "Address"
                            }
                        ]
                    }
                ],
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "dataConnectorName": "Cisco Umbrella (using Azure Functions)",
                "dataTypes": "Cisco_Umbrella_proxy_CL --",
                "version": "1.1.2",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "c9b6d281-b96b-4763-b728-9a04b9fe1246",
                "displayName": "Cisco Umbrella - Connection to non-corporate private network",
                "description": "IP addresses of broadband links that usually indicates users attempting to access their home network, for example for a remote session to a home computer.",
                "kind": "AnalyticsRule",
                "ruleType": "Scheduled",
                "severity": "Medium",
                "query": "Cisco_Umbrella| where EventType == 'proxylogs'| where DvcAction =~ 'Allowed'| where UrlCategory has_any ('Dynamic and Residential', 'Personal VPN')| project TimeGenerated, SrcIpAddr, DstIpAddr, Identities ",
                "ruleFrequency": "10 minutes",
                "rulePeriod": "10 minutes",
                "suppressionDuration": "1 hour",
                "thresholdTrigger": "more than 0",
                "tactics": [
                    "Command And Control",
                    "Exfiltration"
                ],
                "tacticsMultiple": "Command And Control1\ue946Exfiltration",
                "techniques": [
                    "T1573",
                    "T1041"
                ],
                "techniquesMultiple": "T15731\ue946T1041",
                "subTechniques": [],
                "subTechniquesMultiple": [],
                "entityMapping": [
                    {
                        "entityType": "IP",
                        "fieldMappings": [
                            {
                                "columnName": "SrcIpAddr",
                                "identifier": "Address"
                            }
                        ]
                    }
                ],
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "dataConnectorName": "Cisco Umbrella (using Azure Functions)",
                "dataTypes": "Cisco_Umbrella_proxy_CL --",
                "version": "1.0.2",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "de58ee9e-b229-4252-8537-41a4c2f4045e",
                "displayName": "Cisco Umbrella - Request to blocklisted file type",
                "description": "Detects request to potentially harmful file types (.ps1, .bat, .vbs, etc.).",
                "kind": "AnalyticsRule",
                "ruleType": "Scheduled",
                "severity": "Medium",
                "query": "let file_ext_blocklist = dynamic(['.ps1', '.vbs', '.bat', '.scr']);Cisco_Umbrella| where EventType == 'proxylogs'| where DvcAction =~ 'Allowed'| extend file_ext = extract(@'.*(\\.\\w+)$', 1, UrlOriginal)| extend Filename = extract(@'.*\\/*\\/(.*\\.\\w+)$', 1, UrlOriginal)| where file_ext in (file_ext_blocklist)| project TimeGenerated, SrcIpAddr, DstIpAddr, Identities, Filename, UrlOriginal ",
                "ruleFrequency": "10 minutes",
                "rulePeriod": "10 minutes",
                "suppressionDuration": "1 hour",
                "thresholdTrigger": "more than 0",
                "tactics": [
                    "Initial Access",
                    "Command And Control"
                ],
                "tacticsMultiple": "Initial Access1\ue946Command And Control",
                "techniques": [
                    "T1189",
                    "T1105"
                ],
                "techniquesMultiple": "T11891\ue946T1105",
                "subTechniques": [],
                "subTechniquesMultiple": [],
                "entityMapping": [
                    {
                        "entityType": "URL",
                        "fieldMappings": [
                            {
                                "columnName": "UrlOriginal",
                                "identifier": "Url"
                            }
                        ]
                    },
                    {
                        "entityType": "IP",
                        "fieldMappings": [
                            {
                                "columnName": "SrcIpAddr",
                                "identifier": "Address"
                            }
                        ]
                    }
                ],
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "dataConnectorName": "Cisco Umbrella (using Azure Functions)",
                "dataTypes": "Cisco_Umbrella_proxy_CL --",
                "version": "1.0.1",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "d6bf1931-b1eb-448d-90b2-de118559c7ce",
                "displayName": "Cisco Umbrella - Request Allowed to harmful/malicious URI category",
                "description": "It is reccomended that these Categories shoud be blocked by policies because they provide harmful/malicious content..",
                "kind": "AnalyticsRule",
                "ruleType": "Scheduled",
                "severity": "Medium",
                "query": "Cisco_Umbrella| where EventType == 'proxylogs'| where DvcAction =~ 'Allowed'| where UrlCategory contains 'Adult Themes' or      UrlCategory contains 'Adware' or      UrlCategory contains 'Alcohol' or      UrlCategory contains 'Illegal Downloads' or      UrlCategory contains 'Drugs' or      UrlCategory contains 'Child Abuse Content' or      UrlCategory contains 'Hate/Discrimination' or      UrlCategory contains 'Nudity' or      UrlCategory contains 'Pornography' or      UrlCategory contains 'Proxy/Anonymizer' or      UrlCategory contains 'Sexuality' or      UrlCategory contains 'Tasteless' or      UrlCategory contains 'Terrorism' or      UrlCategory contains 'Web Spam' or      UrlCategory contains 'German Youth Protection' or      UrlCategory contains 'Illegal Activities' or      UrlCategory contains 'Lingerie/Bikini' or      UrlCategory contains 'Weapons'| project TimeGenerated, SrcIpAddr, DstIpAddr, UrlOriginal, Identities",
                "ruleFrequency": "10 minutes",
                "rulePeriod": "10 minutes",
                "suppressionDuration": "1 hour",
                "thresholdTrigger": "more than 0",
                "tactics": [
                    "Command And Control",
                    "Exfiltration"
                ],
                "tacticsMultiple": "Command And Control1\ue946Exfiltration",
                "techniques": [
                    "T1071",
                    "T1041"
                ],
                "techniquesMultiple": "T10711\ue946T1041",
                "subTechniques": [
                    "T1071.001"
                ],
                "subTechniquesMultiple": "T1071.001",
                "entityMapping": [
                    {
                        "entityType": "URL",
                        "fieldMappings": [
                            {
                                "columnName": "UrlOriginal",
                                "identifier": "Url"
                            }
                        ]
                    },
                    {
                        "entityType": "IP",
                        "fieldMappings": [
                            {
                                "columnName": "SrcIpAddr",
                                "identifier": "Address"
                            }
                        ]
                    }
                ],
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "dataConnectorName": "Cisco Umbrella (using Azure Functions)",
                "dataTypes": "Cisco_Umbrella_proxy_CL --",
                "version": "1.1.1",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "2b328487-162d-4034-b472-59f1d53684a1",
                "displayName": "Cisco Umbrella - Empty User Agent Detected",
                "description": "Rule helps to detect empty and unusual user agent indicating web browsing activity by an unusual process other than a web browser.",
                "kind": "AnalyticsRule",
                "ruleType": "Scheduled",
                "severity": "Medium",
                "query": "Cisco_Umbrella| where EventType == \"proxylogs\"| where HttpUserAgentOriginal == ''| extend Message = \"Empty User Agent\"| project TimeGenerated, Message, SrcIpAddr, DstIpAddr, UrlOriginal ",
                "ruleFrequency": "15 minutes",
                "rulePeriod": "15 minutes",
                "suppressionDuration": "1 hour",
                "thresholdTrigger": "more than 0",
                "tactics": [
                    "Command And Control"
                ],
                "tacticsMultiple": "Command And Control",
                "techniques": [
                    "T1001"
                ],
                "techniquesMultiple": "T1001",
                "subTechniques": [
                    "T1001.003"
                ],
                "subTechniquesMultiple": "T1001.003",
                "entityMapping": [
                    {
                        "entityType": "URL",
                        "fieldMappings": [
                            {
                                "columnName": "UrlOriginal",
                                "identifier": "Url"
                            }
                        ]
                    },
                    {
                        "entityType": "IP",
                        "fieldMappings": [
                            {
                                "columnName": "SrcIpAddr",
                                "identifier": "Address"
                            }
                        ]
                    }
                ],
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "dataConnectorName": "Cisco Umbrella (using Azure Functions)",
                "dataTypes": "Cisco_Umbrella_proxy_CL --",
                "version": "1.1.2",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "8c8de3fa-6425-4623-9cd9-45de1dd0569a",
                "displayName": "Cisco Umbrella - Rare User Agent Detected",
                "description": "Rule helps to detect a rare user-agents indicating web browsing activity by an unusual process other than a web browser.",
                "kind": "AnalyticsRule",
                "ruleType": "Scheduled",
                "severity": "Medium",
                "query": "let user_agents_list = Cisco_Umbrella| where EventType == \"proxylogs\"| summarize count() by HttpUserAgentOriginal| summarize make_list(HttpUserAgentOriginal);Cisco_Umbrella| where EventType == \"proxylogs\"| where HttpUserAgentOriginal !in (user_agents_list)| extend Message = \"Rare User Agent\"| project TimeGenerated, Message, SrcIpAddr, DstIpAddr, UrlOriginal, HttpUserAgentOriginal",
                "ruleFrequency": "1 day",
                "rulePeriod": "14 days",
                "suppressionDuration": "1 hour",
                "thresholdTrigger": "more than 0",
                "tactics": [
                    "Command And Control",
                    "Exfiltration"
                ],
                "tacticsMultiple": "Command And Control1\ue946Exfiltration",
                "techniques": [
                    "T1071",
                    "T1041"
                ],
                "techniquesMultiple": "T10711\ue946T1041",
                "subTechniques": [
                    "T1071.001"
                ],
                "subTechniquesMultiple": "T1071.001",
                "entityMapping": [
                    {
                        "entityType": "URL",
                        "fieldMappings": [
                            {
                                "columnName": "UrlOriginal",
                                "identifier": "Url"
                            }
                        ]
                    },
                    {
                        "entityType": "IP",
                        "fieldMappings": [
                            {
                                "columnName": "SrcIpAddr",
                                "identifier": "Address"
                            }
                        ]
                    }
                ],
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "dataConnectorName": "Cisco Umbrella (using Azure Functions)",
                "dataTypes": "Cisco_Umbrella_proxy_CL --",
                "version": "1.1.2",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            }
        ]
    },
    "HuntingQueries": {
        "huntingQuery": [
            {
                "searchKey": "55393e5b-3f7e-4d40-85e5-38ef9ecd8484",
                "displayName": "Cisco Umbrella - Higher values of count of the Same BytesIn size",
                "description": "Calculate the count of BytesIn per Source-Destination pair over 24 hours. Higher values may indicate beaconing.",
                "kind": "HuntingQuery",
                "query": "let timeframe = 1d;Cisco_Umbrella | where EventType == \"proxylogs\"| where TimeGenerated > ago(timeframe)| summarize count() by SrcIpAddr,DstIpAddr, SrcBytes| sort by count_ desc| extend Message = \"Possible communication with C2\"| project Message, SrcIpAddr, DstIpAddr| extend IpCustomEntity = SrcIpAddr",
                "tactics": [
                    "Command And Control"
                ],
                "techniques": [
                    "T1071"
                ],
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "c92741e6-8454-40bb-8830-069cb86946c6",
                "displayName": "Cisco Umbrella - Anomalous FQDNs for domain",
                "description": "Large number of FQDNs for domain may be indicator of suspicious domain.",
                "kind": "HuntingQuery",
                "query": "Cisco_Umbrella| where TimeGenerated > ago(24h)| where EventType == 'dnslogs'| extend replaced = replace(@'\\.$', @'', DnsQueryName)| extend Domain = extract(@'.*\\.(.*\\.[a-z]+)', 1, replaced)| extend fqdn = extract(@'(.*)\\..*\\.[a-z]+', 1, replaced)| summarize FQDNs = dcount(fqdn) by Domain| sort by FQDNs",
                "tactics": [
                    "Command And Control"
                ],
                "techniques": [
                    "T1071"
                ],
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "de2ec986-ee24-465f-adf2-b718997074c1",
                "displayName": "Cisco Umbrella - Requests to uncategorized resources",
                "description": "Shows requests to URL where UrlCategory is not set.",
                "kind": "HuntingQuery",
                "query": "Cisco_Umbrella| where TimeGenerated > ago(24h)| where DvcAction =~ 'Allowed'| where UrlCategory == ''| project UrlOriginal, Identities| extend URLCustomEntity = UrlOriginal| extend AccountCustomEntity = Identities",
                "tactics": [
                    "Initial Access"
                ],
                "techniques": [
                    "T1071"
                ],
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "975419eb-7041-419c-b8f0-c4bf513cf2b2",
                "displayName": "Cisco Umbrella - High values of Uploaded Data",
                "description": "A normal user activity consists mostly of downloading data. Uploaded data is usually small unless there is a file/data upload to a website. Calculate the sum of BytesOut per Source-Destination pair over 12/24 hours.",
                "kind": "HuntingQuery",
                "query": "let timeframe = 1d;Cisco_Umbrella | where EventType == \"proxylogs\"| where TimeGenerated > ago(timeframe)| summarize sum(SrcBytes) by SrcIpAddr,DstIpAddr| sort by sum_SrcBytes desc| project SrcIpAddr, DstIpAddr| extend IpCustomEntity = SrcIpAddr",
                "tactics": [
                    "Exfiltration"
                ],
                "techniques": [
                    "T1020"
                ],
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "daf2f3cf-0f0d-45c1-b428-3c23d643859b",
                "displayName": "Cisco Umbrella - Proxy 'Allowed' to unreliable categories.",
                "description": "Shows allowed requests to URI categories which heavily are used in Initial Access stage by threat actiors and may contain malicious content.",
                "kind": "HuntingQuery",
                "query": "Cisco_Umbrella| where TimeGenerated > ago(24h)| where EventType == 'proxylogs'| where UrlCategory contains 'Dating' or UrlCategory contains 'Digital Postcards' or UrlCategory contains 'Freeware and Shareware' or UrlCategory contains 'Gambling' or UrlCategory contains  'Hacking' or UrlCategory contains 'Hunting' or UrlCategory contains 'Mobile Phones' or UrlCategory contains 'Software Updates' or UrlCategory contains 'URL Shortener' or UrlCategory contains  'Web Hosting'| where DvcAction == 'ALLOWED'| summarize TotalEvents = count() by UrlOriginal, SrcIpAddr| sort by TotalEvents| summarize listOfIps = make_set(SrcIpAddr) by UrlOriginal| extend URLCustomEntity = UrlOriginal",
                "tactics": [
                    "Initial Access"
                ],
                "techniques": [
                    "T1189"
                ],
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "bd1457df-3e81-4218-a079-0963200c8d67",
                "displayName": "Cisco Umbrella - DNS requests to unreliable categories.",
                "description": "Shows requests to URI categories which heavily are used in Initial Access stage by threat actiors and may contain malicious content.",
                "kind": "HuntingQuery",
                "query": "Cisco_Umbrella| where TimeGenerated > ago(24h)| where EventType == 'dnslogs'| where UrlCategory contains 'Dating' or UrlCategory contains 'Digital Postcards' or UrlCategory contains 'Freeware and Shareware' or UrlCategory contains 'Gambling' or UrlCategory contains  'Hacking' or UrlCategory contains 'Hunting' or UrlCategory contains 'Mobile Phones' or UrlCategory contains 'Software Updates' or UrlCategory contains 'URL Shortener' or UrlCategory contains  'Web Hosting'| where DvcAction == 'Allowed'| summarize TotalEvents = count() by DnsQueryName, SrcIpAddr| sort by TotalEvents| summarize listOfIps = make_set(SrcIpAddr) by DnsQueryName| extend URLCustomEntity = DnsQueryName",
                "tactics": [
                    "Initial Access"
                ],
                "techniques": [
                    "T1189"
                ],
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "26aebe0d-9a4f-456d-bbb9-9f4c9c5d28ca",
                "displayName": "Cisco Umbrella - DNS Errors.",
                "description": "Shows error DNS requests.",
                "kind": "HuntingQuery",
                "query": "Cisco_Umbrella| where TimeGenerated > ago(24h)| where EventType == 'dnslogs'| where DnsResponseCodeName != 'NOERROR'| extend URLCustomEntity = UrlOriginal| extend AccountCustomEntity = Identities| extend IPCustomEntity = SrcIpAddr",
                "tactics": [
                    "Initial Access"
                ],
                "techniques": [
                    "T1189"
                ],
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "497d7250-87e1-49b1-a096-94f61c7ade9c",
                "displayName": "Cisco Umbrella - Possible data exfiltration",
                "description": "A normal user activity consists mostly of downloading data. Uploaded data is usually small unless there is a file/data upload to a website. Calculate the sum of BytesOut per Source-Destination pair over 12/24 hours.",
                "kind": "HuntingQuery",
                "query": "let timeframe = 1d;Cisco_Umbrella | where EventType == \"proxylogs\"| where TimeGenerated > ago(timeframe)| summarize sum(DstBytes) by SrcIpAddr,DstIpAddr| sort by sum_DstBytes desc| extend Message = \"Possible data exfiltration\"| extend IPCustomEntity = SrcIpAddr",
                "tactics": [
                    "Exfiltration"
                ],
                "techniques": [
                    "T1020"
                ],
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "22e5e573-409b-433f-91de-50d6f0ad5a9e",
                "displayName": "Cisco Umbrella - 'Blocked' User-Agents.",
                "description": "Shows User-Agent values which requests were blocked",
                "kind": "HuntingQuery",
                "query": "Cisco_Umbrella| where TimeGenerated > ago(24h)| where DvcAction =~ 'Blocked'| summarize count() by HttpUserAgentOriginal| sort by count_",
                "tactics": [
                    "Exfiltration"
                ],
                "techniques": [
                    "T1020"
                ],
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "85421f18-2de4-42ff-9ef4-058924dcb1bf",
                "displayName": "Cisco Umbrella - Possible connection to C2.",
                "description": "Calculate the count of BytesIn per Source-Destination pair over 12/24 hours. Higher values may indicate beaconing. C2 servers reply with the same data, making BytesIn value the same.",
                "kind": "HuntingQuery",
                "query": "let timeframe = 1d;Cisco_Umbrella | where EventType == \"proxylogs\"| where TimeGenerated > ago(timeframe)| summarize count() by SrcIpAddr, DstIpAddr, SrcBytes| sort by count_ desc| extend Message = \"Possible communication with C2\"| extend IPCustomEntity = SrcIpAddr",
                "tactics": [
                    "Command And Control"
                ],
                "techniques": [
                    "T1071"
                ],
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            }
        ]
    },
    "Workbooks": {
        "workbook": [
            {
                "searchKey": "CiscoUmbrellaWorkbook",
                "displayName": "Cisco Umbrella",
                "description": "Gain insights into Cisco Umbrella activities, including the DNS, Proxy and Cloud Firewall data. Workbook shows general information along with threat landscape including categories, blocked destinations and URLs.",
                "kind": "Workbook",
                "dataTypes": "Cisco_Umbrella_dns_CL --Cisco_Umbrella_proxy_CL --Cisco_Umbrella_ip_CL --Cisco_Umbrella_cloudfirewall_CL --",
                "dataConnectorId": "CiscoUmbrellaDataConnector",
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            }
        ]
    },
    "Parsers": {
        "parser": [
            {
                "searchKey": "Cisco_Umbrella-Parser",
                "displayName": "CiscoUmbrella Data Parser",
                "kind": "Parser",
                "functionAlias": "Cisco_Umbrella",
                "query": "let Cisco_Umbrella_dns_view = view () {     Cisco_Umbrella_dns_CL    | extend         EventEndTime=column_ifexists('Timestamp_t', ''),        SrcIpAddr=column_ifexists('InternalIp_s', ''),        SrcNatIpAddr=column_ifexists('ExternalIp_s', ''),        DvcAction=column_ifexists('Action_s', ''),        DnsQueryName=column_ifexists('Domain_s', ''),        UrlCategory=column_ifexists('Categories_s', ''),        ThreatCategory=column_ifexists('Blocked_Categories_s', ''),        Identities=column_ifexists('Identities_s', ''),        DnsQueryTypeName=column_ifexists('QueryType_s', ''),        DnsResponseCodeName=column_ifexists('ResponseCode_s', ''),        IdentityTypes=column_ifexists('Identity_Types_s', ''),        EventType=column_ifexists('EventType_s', ''),        PolicyIdentity=column_ifexists('Policy_Identity_s', ''),        PolicyIdentityType=column_ifexists('Policy_Identity_Type_s', '')    | project         TimeGenerated,        EventEndTime,        SrcIpAddr,        SrcNatIpAddr,        DvcAction,        DnsQueryName,        UrlCategory,        ThreatCategory,        Identities,        DnsQueryTypeName,        DnsResponseCodeName,        IdentityTypes,        EventType,        PolicyIdentity,        PolicyIdentityType};let Cisco_Umbrella_proxy_view = view () {     Cisco_Umbrella_proxy_CL    | extend         EventType=column_ifexists('EventType_s', ''),        EventEndTime=column_ifexists('Timestamp_t', ''),        Identities=column_ifexists('Identities_s', ''),        SrcIpAddr=column_ifexists('Internal_IP_s', ''),        SrcNatIpAddr=column_ifexists('External_IP_s', ''),        DstIpAddr=column_ifexists('Destination_IP_s', ''),        HttpContentType=column_ifexists('Content_Type_s', ''),        DvcAction=column_ifexists('Verdict_s', ''),        UrlOriginal=column_ifexists('URL_s', ''),        HttpReferrerOriginal=column_ifexists('Referer_s', ''),        HttpUserAgentOriginal=column_ifexists('userAgent_s', ''),        HttpStatusCode=column_ifexists('statusCode_s', ''),        SrcBytes=column_ifexists('requestSize_d', ''),        DstBytes=column_ifexists('responseSize_d', ''),        HttpResponseBodyBytes=column_ifexists('responseBodySize_d', ''),        HashSha256=column_ifexists('SHA-SHA256_s', ''),        UrlCategory=column_ifexists('Categories_s', ''),        AvDetections=column_ifexists('AVDetections_s', ''),        Puas=column_ifexists('PUAs_s', ''),        AmpDisposition=column_ifexists('AMP_Disposition_s', ''),         ThreatName=column_ifexists('AMP_Malware_Name_s', ''),        AmpScore=column_ifexists('AMP_Score_s', ''),        IdentityType=column_ifexists('Identity_Type_s', ''),        ThreatCategory=column_ifexists('Blocked_Categories_s', '')    | project        TimeGenerated,        EventType,        EventEndTime,        Identities,        SrcIpAddr,        SrcNatIpAddr,        DstIpAddr,        HttpContentType,        DvcAction,        UrlOriginal,        HttpReferrerOriginal,        HttpUserAgentOriginal,        HttpStatusCode,        SrcBytes,        DstBytes,        HttpResponseBodyBytes,        HashSha256,        UrlCategory,        AvDetections,        Puas,        AmpDisposition,        ThreatName,        AmpScore,        IdentityType,        ThreatCategory};let Cisco_Umbrella_ip_view = view () {     Cisco_Umbrella_ip_CL    | extend         EventType=column_ifexists('EventType_s', ''),        EventEndTime=column_ifexists('Timestamp_t', ''),        Identities=column_ifexists('Identity_s', ''),        SrcIpAddr=column_ifexists('Source_IP_s', ''),        SrcPortNumber=column_ifexists('Source_Port_s', ''),        DstIpAddr=column_ifexists('Destination_IP_s', ''),        DstPortNumber=column_ifexists('Destination_Port_s', ''),        UrlCategory=column_ifexists('Categories_s', '')    | project        TimeGenerated,        EventType,        EventEndTime,        Identities,        SrcIpAddr,        SrcPortNumber,        DstIpAddr,        DstPortNumber,        UrlCategory};let Cisco_Umbrella_cloudfirewall_view = view () {     Cisco_Umbrella_cloudfirewall_CL    | extend         EventType=column_ifexists('EventType_s', ''),        EventEndTime=column_ifexists('Timestamp_t', ''),        NetworkSessionId=column_ifexists('originId_s', ''),        NetworkRuleName=column_ifexists('Identity_s', ''),        IdentityType=column_ifexists('Identity_Type_s', ''),        NetworkDirection=column_ifexists('Direction_s', ''),        NetworkProtocol=column_ifexists('ipProtocol_s', ''),        NetworkPackets=column_ifexists('packetSize_s', ''),        SrcIpAddr=column_ifexists('SourceIP', ''),        SrcPortNumber=column_ifexists('sourcePort_s', ''),        DstIpAddr=column_ifexists('destinationIp_s', ''),        DstPortNumber=column_ifexists('destinationPort_s', ''),        DvcHostname=column_ifexists('dataCenter_s', ''),        NetworkRuleNumber=column_ifexists('ruleId_s', ''),        DvcAction=column_ifexists('verdict_s', '')    | project        TimeGenerated,        EventType,        EventEndTime,        NetworkSessionId,        NetworkRuleName,        IdentityType,        NetworkDirection,        NetworkProtocol,        NetworkPackets,        SrcIpAddr,        SrcPortNumber,        DstIpAddr,        DstPortNumber,        DvcHostname,        NetworkRuleNumber,        DvcAction};union isfuzzy=true Cisco_Umbrella_dns_view, Cisco_Umbrella_proxy_view, Cisco_Umbrella_ip_view, Cisco_Umbrella_cloudfirewall_view",
                "version": "1.0.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            }
        ]
    },
    "Playbooks": {
        "playbook": [
            {
                "searchKey": "CiscoUmbrella-BlockDomain",
                "displayName": "CiscoUmbrella-BlockDomain",
                "description": "This playbook showcases an example of triggering an incident within a targeted Teams channel and opening up a ticket within Service Now. Additionally The playbook will also list playbooks that can be initiated from teams using an adaptive card and callbacks that will take action upon certain entities identified in the incident.",
                "kind": "Playbook",
                "prerequisites": "ServiceNow Instance URL, Username, and password.Access and authorization to enable API connectorsTeams Group ID, Channel ID and Alert details where the messages are to be posted in.",
                "postDeployment": "",
                "entities": [
                    "Account",
                    "2\ue946",
                    "URL",
                    "Host"
                ],
                "entitiesMultiple": "Account2\ue946URLHost",
                "tags": "SyncNotificationTeams Response",
                "version": "1.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "CiscoUmbrella-AddIpToDestinationList",
                "displayName": "CiscoUmbrella-AddIpToDestinationList",
                "description": "This playbook showcases an example of triggering an incident within a targeted Teams channel and opening up a ticket within Service Now. Additionally The playbook will also list playbooks that can be initiated from teams using an adaptive card and callbacks that will take action upon certain entities identified in the incident.",
                "kind": "Playbook",
                "prerequisites": "ServiceNow Instance URL, Username, and password.Access and authorization to enable API connectorsTeams Group ID, Channel ID and Alert details where the messages are to be posted in.",
                "postDeployment": "",
                "entities": [
                    "Account",
                    "2\ue946",
                    "URL",
                    "Host"
                ],
                "entitiesMultiple": "Account2\ue946URLHost",
                "tags": "SyncNotificationTeams Response",
                "version": "1.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "CiscoUmbrella-GetDomainInfo",
                "displayName": "CiscoUmbrella-GetDomainInfo",
                "description": "This playbook showcases an example of triggering an incident within a targeted Teams channel and opening up a ticket within Service Now. Additionally The playbook will also list playbooks that can be initiated from teams using an adaptive card and callbacks that will take action upon certain entities identified in the incident.",
                "kind": "Playbook",
                "prerequisites": "ServiceNow Instance URL, Username, and password.Access and authorization to enable API connectorsTeams Group ID, Channel ID and Alert details where the messages are to be posted in.",
                "postDeployment": "",
                "entities": [
                    "Account",
                    "2\ue946",
                    "URL",
                    "Host"
                ],
                "entitiesMultiple": "Account2\ue946URLHost",
                "tags": "SyncNotificationTeams Response",
                "version": "1.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            },
            {
                "searchKey": "CiscoUmbrella-AssignPolicyToIdentity",
                "displayName": "CiscoUmbrella-AssignPolicyToIdentity",
                "description": "This playbook showcases an example of triggering an incident within a targeted Teams channel and opening up a ticket within Service Now. Additionally The playbook will also list playbooks that can be initiated from teams using an adaptive card and callbacks that will take action upon certain entities identified in the incident.",
                "kind": "Playbook",
                "prerequisites": "ServiceNow Instance URL, Username, and password.Access and authorization to enable API connectorsTeams Group ID, Channel ID and Alert details where the messages are to be posted in.",
                "postDeployment": "",
                "entities": [
                    "Account",
                    "2\ue946",
                    "URL",
                    "Host"
                ],
                "entitiesMultiple": "Account2\ue946URLHost",
                "tags": "SyncNotificationTeams Response",
                "version": "1.0",
                "source": "CiscoUmbrella",
                "author": "Microsoft",
                "support": "Microsoft Corporation",
                "solutionSearchName": "Cisco Umbrella"
            }
        ]
    },
    "LogicApps": {
        "logicAppsCustomConnector": []
    },
    "Watchlists": {
        "watchlist": []
    }
}